{% load bootstrap3 %}
{% load staticfiles i18n %}
<!DOCTYPE HTML>
<html lang="en">
<head>
    {# Load CSS and JavaScript #}
    {% bootstrap_css %}
    <script type="text/javascript" src="{% static 'js/jquery.js' %}"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta charset="UTF-8">
    <title>{% trans "Firefox Profilemaker" %}</title>
    <style>
        body {
           background-color: #eaf3e8;
       }
       .navbar {
           background-color: white;
           border: thin solid black;
       }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">{% trans "Firefox Profilemaker" %}</a>
            </div>
            <div>
                <ul class="nav navbar-nav nav-pills">
                    <li class="active"><a href="#start" data-toggle="tab">{% trans "Start" %}</a></li>

                    {% for form in forms %}
                    <li>
                        <a href="#{{ form.id }}" data-toggle="tab" style="{% if form.is_valid %}font-weight: bold{% endif %}">{% if form.is_valid %}{% bootstrap_icon "star" %}{% else %}{% bootstrap_icon "star-empty" %}{% endif %} {{ form.name }}</a>
                    </li>
                    {% endfor %}
                    <li><a href="#finish" data-toggle="tab" style="{% if finished %}font-weight: bold{% endif %}">{% if finished %}{% bootstrap_icon "star" %} {% endif %}{% trans "Finish" %}</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        {% bootstrap_messages %}

        <div class="tab-content">
            <div id="start" class="tab-pane fade in active">
                <h1>{% trans "Firefox Profilemaker" %}</h1>
                {% blocktrans %}
                Welcome to the Firefox Profilemaker!
                <p />
                This tool will help you to create a firefox profile with the defaults you like.
                <p />
                You select which features you want to enable and disable and in the end
                you get a download link for a zip-file with your profile template.
                You can for example disable some functions, which send data to mozilla and google,
                or disable several annoying firefox functions like Mozilla Hello or the Pocket integration.
                <p />
                Each Setting has a short explanation and for the non obvious settings links to ressources
                describing the feature and the possible problems with it.
                <p />
                {% endblocktrans %}
                <a href="#{{ forms.0.id }}" data-toggle="tab">
                    <button type="submit" class="btn btn-primary" onclick="$('.nav-pills a[href=#{{ forms.0.id }}]').tab('show');">
                        {% trans "Start" %}
                    </button>
                </a>
            </div>
        {% for form in forms %}
            <div id="{{ form.id }}" class="tab-pane fade">
                <h1>{{ form.name }}</h1>
                <form action="#{{ form.id }}" method="post" class="form">
                  {% csrf_token %}
                  {% bootstrap_form form %}
                  {% buttons %}
                    <button type="submit" class="btn">
                      {% bootstrap_icon "star" %} save
                    </button>
                    <button type="submit" class="btn btn-primary" name="next" value="{{ form.next }}">
                      {% bootstrap_icon "ok" %} {% trans "save &amp; next" %}
                    </button>
                  {% endbuttons %}
                </form>
            </div>
            {% endfor %}
            <div id="finish" class="tab-pane fade">
                <h1>{% trans "Download" %}</h1>
                {% if not finished %}
                    <div class="alert alert-danger" role="alert">
                        {% trans "Please fill in all questions before downloading your profile." %}"
                    </div>
                    <p />
                {% endif %}

                <a href="{% url 'profilemaker.views.download' 'profile.zip' %}" class="btn btn-primary" style="margin-bottom: 1ex">{% bootstrap_icon "download" %} {% trans "Download profile.zip" %}</a>
                <a href="{% url 'profilemaker.views.download' 'prefs.js' %}" class="btn btn-primary" style="margin-bottom: 1ex">{% bootstrap_icon "download" %} {% trans "Download prefs.js only" %}</a>
                <a href="{% url 'profilemaker.views.download' 'prefs.js.txt' %}" class="btn btn-primary" style="margin-bottom: 1ex">{% bootstrap_icon "download" %} {% trans "Open prefs.js in the browser" %}</a>


                <form action="#" method="post" class="form">
                  {% csrf_token %}
                  {% buttons %}
                    <button type="submit" class="btn btn-primary" name="reset" value="reset">
                      {% bootstrap_icon "trash" %} {% trans "Start over again" %}
                    </button>
                  {% endbuttons %}
                </form>

                <h3>{% trans "Installing" %}</h3>
                <ul>
                    <li>{% trans "Optional: add a new profile to keep the old one" %}</li>
                    <ul>
                        <li>{% trans "Run" %} <code>firefox -no-remote -ProfileManager</code></li>
                        <li>{% trans "Create a new profile and note the profile folder (something like <code>.mozilla/firefox/m35kxjmd.profilename</code>)" %}</li>
                    </ul>
                    {% blocktrans %}
                    <li>Open the profile folder.</li>
                    <li>Delete everything from the new profile (you will lose all existing data from the profile).</li>
                    <li>unzip the <code>profile.zip</code> file into the folder.</li>
                    <li>Start firefox again. If you made a new profile, you can use it with <code>firefox -no-remote -P profilename</code>.</li>
                    <li>Open the addon manager and update the extensions.</li>
                    {% endblocktrans %}
                </ul>
                <h3>{% trans "Preview" %}</h3>

                prefs.js:
                <pre>{{ prefs_js }}</pre>

                {% if addons %}
                    {% trans "Addons:" %}
                    <pre>{% for addon in addons %}{{ addon }}<br />{% endfor %}</pre>
                {% endif %}
            </div>
        </div>
    </div>
    {% bootstrap_javascript %}
    <script>
        // Javascript to enable link to tab
        var url = document.location.toString();
        if (url.match('#')) {
            $('.nav-pills a[href=#'+url.split('#')[1]+']').tab('show');
        }
        // Change hash for page-reload
        $('.nav-pills a').on('shown.bs.tab', function (e) {
            window.location.hash = e.target.hash;
        });
    </script>
    <a href="https://github.com/allo-/firefox-profilemaker"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
</body>
</html>
